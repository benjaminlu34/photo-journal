{
  "component": "StickyNoteBlock",
  "version": "v1.1-drag-hotfix",
  "issuesFixed": [
    "Text on other notes becomes selected while dragging",
    "Sticky lags behind pointer because every transform change is animated"
  ],
  "changes": [
    {
      "type": "css",
      "payload": {
        "add": [
          {
            "selector": "body.user-select-none",
            "rules": { "user-select": "none !important" }
          }
        ]
      }
    },
    {
      "type": "code-diff",
      "file": "content-block.tsx",
      "diff": [
        "@@ startMove",
        "+  e.currentTarget.setPointerCapture(e.pointerId); // keep pointer stream on grip",
        "+  document.body.classList.add('user-select-none'); // block text selection",
        "",
        "@@ endMove",
        "+  e.currentTarget.releasePointerCapture(e.pointerId);",
        "+  document.body.classList.remove('user-select-none');",
        "",
        "@@ component <outer-div className>",
        "-  className={`absolute rounded-2xl transition-all group interactive ${getBlockColor()} hover:sticky-note ${",
        "-    isDragging ? \"opacity-80 scale-105\" : \"\"",
        "-  } ${isResizing ? \"select-none\" : \"\"}`}",
        "+  className={`absolute rounded-2xl group interactive ${getBlockColor()} hover:sticky-note",
        "+    ${isDragging ? 'opacity-80 scale-105' : ''}",
        "+    ${isResizing ? 'select-none' : ''}",
        "+    ${!isDragging && !isResizing ? 'transition-shadow duration-200' : ''}" ,
        "+  }`}",
        "",
        "@@ moveBlock (top of fn)",
        "+  e.preventDefault(); // suppress browser drag-select fallback"
      ]
    }
  ],
  "why_it_works": {
    "pointer_capture": "Guarantees all pointermove events are delivered to the grip—even when cursor crosses over other stickies—so no underlying text receives the drag selection.",
    "user_select_none": "Temporarily disables browser text-selection for the whole page, eliminating violet highlight bars you observed.",
    "transition_shadow_only": "We strip the generic `transition-all` while a note is in motion; transform changes now apply instantly at 60 fps. When idle, we still animate shadow for hover delight."
  },
  "test_plan": [
    "1. Drag a sticky across other stickies → verify no text highlights.",
    "2. Observe sticky follows cursor 1:1 with no visual lag.",
    "3. Release mouse → transform instantly stops; note ends exactly under pointer.",
    "4. Hover idle sticky → shadow fades in/out smoothly (transition still works)."
  ]
}
